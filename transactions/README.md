# Avoid using INNODB_TRX

Using the MySQL Performance Schema is the best practice and the future of MySQL performance reporting.  
But the MySQL Information Schema is still widely used and it can report long-running transactions by querying table `information_schema.innodb_trx`.  
I advise using the Performance Schema because it contains significantly more detailâ€”essentially everything there is to know about what happens inside MySQL.  
(in rare cases, some information is still only available in the Information Schema.)

# perfomance_schema

| Table                            | Description                                                                                                                                                                                                                                                                                                                     |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| events_transactions_current      | Transactions that are ongoing as well as the latest transaction for threads that are still connected but that have not yet started a new transaction.                                                                                                                                                                           |
| events_transactions_history      | The last ten transactions (can be changed with the `performance_schema_events_transactions_history_size`) for each existing thread.                                                                                                                                                                                             |
| events_transactions_history_long | The last 10000 transactions (the `performance_schema_events_transactions_history_long_size` option) for the instance. It also includes transactions for disconnected threads. The consumer for this table is disabled by default.                                                                                               |
| events_statements_history        | The last statements for each connection. The number of statements per connection is capped at performance_schema_events_statements_history_size (defaults to 10). The statements for a connection are removed when the connection is closed.                                                                                    |
| events_statements_history_long   | The latest queries for the instance irrespective of which connection executed it. This table also includes statements from connections that have been closed. The consumer for this table is disabled by default. The number of rows is capped at `performance_schema_events_statements_history_long_size` (defaults to 10000). |

# INNODB_TRX

The `INNODB_TRX` view in the Information Schema is the most dedicated source of information about InnoDB transactions.  
It includes information such as when the transaction started, how many rows have been modified, and how many locks are held.  
The `INNODB_TRX` view is also used by the `sys.innodb_lock_waits` view to provide some information about the transactions involved in lock wait issues.

| Column                     | Data Type       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| -------------------------- | --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| trx_id                     | varchar(18)     | The transaction id. This can be useful when referring to the transaction or comparing with the output of the InnoDB monitor. Otherwise, the id should be treated purely internal and not be given any significance. The id is only assigned to transactions that have modified data or locked rows; a transaction that only has executed read-only SELECT statements will have a dummy id like 421124985258256 which will change if the transaction starts to modify or lock records. |
| trx_state                  | varchar(13)     | The state of the transaction. This can be one of RUNNING, LOCK WAIT, ROLLING BACK, and COMMITTING.                                                                                                                                                                                                                                                                                                                                                                                    |
| trx_started                | datetime        | When the transaction was started using the system time zone.                                                                                                                                                                                                                                                                                                                                                                                                                          |
| trx_requested_lock_id      | varchar(105)    | When the trx_state is LOCK WAIT, this column shows the id of the lock that the transaction is waiting for.                                                                                                                                                                                                                                                                                                                                                                            |
| trx_wait_started           | datetime        | When the trx_state is LOCK WAIT, this column shows when the lock wait started using the system time zone.                                                                                                                                                                                                                                                                                                                                                                             |
| trx_weight                 | bigint unsigned | A measure of how much work has been done by the transaction in terms of rows modified and locks held. This is the weight that is used to determine which transaction is rolled back in case of a deadlock. The higher the weight, the more work has been done.                                                                                                                                                                                                                        |
| trx_mysql_thread_id        | bigint unsigned | The connection id (the same as the PROCESSLIST_ID column in the Performance Schema threads table) of the connection executing the transaction.                                                                                                                                                                                                                                                                                                                                        |
| trx_query                  | varchar(1024)   | The query currently executed by the transaction. If the transaction is idle, the query is NULL.                                                                                                                                                                                                                                                                                                                                                                                       |
| trx_operation_state        | varchar(64)     | The current operation performed by the transaction. This may be NULL even when a query is executing.                                                                                                                                                                                                                                                                                                                                                                                  |
| trx_tables_in_use          | bigint unsigned | The number of tables the transaction has used.                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| trx_tables_locked          | bigint unsigned | The number of tables the transaction holds row locks in.                                                                                                                                                                                                                                                                                                                                                                                                                              |
| trx_lock_structs           | bigint unsigned | The number of lock structures created by the transaction.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| trx_lock_memory_bytes      | bigint unsigned | The amount of memory in bytes used by the locks held by the transaction.                                                                                                                                                                                                                                                                                                                                                                                                              |
| trx_rows_locked            | bigint unsigned | The number of record locks held by the transaction. While called row locks, it also includes index locks.                                                                                                                                                                                                                                                                                                                                                                             |
| trx_rows_modified          | bigint unsigned | The number of rows modified by the transaction.                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| trx_concurrency_tickets    | bigint unsigned | When innodb_thread_concurrency is not 0, a transaction is assigned innodb_concurrency_tickets tickets that it can use before it must allow another transaction to perform work. One ticket corresponds to accessing one row. This column shows how many tickets are left.                                                                                                                                                                                                             |
| trx_isolation_level        | varchar(16)     | The transaction isolation level used for the transaction.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| trx_unique_checks          | int             | Whether the unique_checks variable is enabled for the connection.                                                                                                                                                                                                                                                                                                                                                                                                                     |
| trx_foreign_key_checks     | int             | Whether the foreign_key_checks variable is enabled for the connection.                                                                                                                                                                                                                                                                                                                                                                                                                |
| trx_last_foreign_key_error | varchar(256)    | The error message of the last (if any) foreign key error encountered by the transaction.                                                                                                                                                                                                                                                                                                                                                                                              |
| trx_adaptive_hash_latched  | int             | Whether the transaction has locked a part of the adaptive hash index. There is a total of innodb_adaptive_hash_index_parts parts. This column is effectively a Boolean value.                                                                                                                                                                                                                                                                                                         |
| trx_adaptive_hash_timeout  | bigint unsigned | Whether to keep the lock on the adaptive hash index across multiple queries. If there is only one part for the adaptive hash index and there is no contention, then the timeout counts down, and the lock is released when the timeout reaches 0. When there is contention or there are multiple parts, the lock is always released after each query, and the timeout value is 0.                                                                                                     |
| trx_is_read_only           | int             | Whether the transaction is a read-only transaction. A transaction can be read-only either by declaring it explicitly or for single-statement transactions with autocommit enabled where InnoDB can detect that the query will only read data.                                                                                                                                                                                                                                         |
| trx_autocommit_non_locking | int             | When the transaction is a single-statement non-locking SELECT and the autocommit option is enabled, this column is set to 1. When both this column and trx_is_read_only are 1, InnoDB can optimize the transaction to reduce the overhead.                                                                                                                                                                                                                                            |
| trx_schedule_weight        | bigint unsigned | The transaction weight that is assigned to the transaction by the Contention-Aware Transaction Scheduling (CATS) algorithm (see Chapter 8). The value only has a meaning for transactions in the LOCK WAIT state. This column was added in 8.0.20.                                                                                                                                                                                                                                    |
